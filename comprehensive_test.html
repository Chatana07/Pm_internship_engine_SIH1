<!DOCTYPE html>
<html>
<head>
    <title>Comprehensive Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Comprehensive Test for AI Recommendations</h1>
    
    <div class="test-section">
        <h2>1. Backend Health Check</h2>
        <button id="testHealth">Test Backend Health</button>
        <div id="healthResult"></div>
    </div>
    
    <div class="test-section">
        <h2>2. Form Data Test</h2>
        <button id="testFormData">Test Form Data Collection</button>
        <div id="formDataResult"></div>
    </div>
    
    <div class="test-section">
        <h2>3. AI Recommendation Test</h2>
        <button id="testAI">Test AI Recommendation</button>
        <div id="aiResult"></div>
    </div>
    
    <div class="test-section">
        <h2>4. Full Form Submission Test</h2>
        <form id="testForm">
            <div>
                <label>Name: <input type="text" id="name" value="John Doe"></label>
            </div>
            <div>
                <label>Citizenship: <select id="citizenship"><option selected>Indian</option></select></label>
            </div>
            <div>
                <label>Age: <input type="number" id="age" value="22"></label>
            </div>
            <div>
                <label>Education: <select id="eduMin"><option selected>BCA</option></select></label>
            </div>
            <div>
                <label>Skills: <input type="text" id="skills" value="Python, SQL, Machine Learning"></label>
            </div>
            <div>
                <label>Domain: <select id="domain"><option selected>Data Science</option></select></label>
            </div>
            <div>
                <label>Location: <select id="location"><option selected>Remote</option></select></label>
            </div>
            <div>
                <label>Duration: <select id="duration"><option selected>12 Months</option></select></label>
            </div>
            <div>
                <label>Enrollment Status: 
                    <select id="edu">
                        <option value="Not in full-time" selected>Not in full-time job/study</option>
                        <option value="Enrolled full-time">Enrolled in full-time study/job (ineligible)</option>
                        <option value="Distance/Online OK">Distance / Online program</option>
                    </select>
                </label>
            </div>
            <div>
                <label>Income: <select id="income"><option selected>Up to ₹8,00,000</option></select></label>
            </div>
            <div>
                <label>Aadhaar Linked: 
                    <select id="aadhaarLink">
                        <option value="yes" selected>Yes</option>
                        <option value="no">No</option>
                    </select>
                </label>
            </div>
            <div>
                <label>Govt Job: 
                    <select id="govtJob">
                        <option value="no" selected>No</option>
                        <option value="yes">Yes</option>
                    </select>
                </label>
            </div>
            <button type="button" id="submitTestForm">Submit Test Form</button>
        </form>
        <div id="formSubmitResult"></div>
    </div>

    <script>
        // Test backend health
        document.getElementById('testHealth').addEventListener('click', async function() {
            const resultDiv = document.getElementById('healthResult');
            resultDiv.innerHTML = '<p class="info">Testing backend health...</p>';
            
            try {
                const response = await fetch('http://localhost:5000/health');
                const data = await response.json();
                resultDiv.innerHTML = `<p class="success">✅ Health check successful</p><pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                resultDiv.innerHTML = `<p class="error">❌ Health check failed: ${error.message}</p>`;
            }
        });
        
        // Test form data collection
        document.getElementById('testFormData').addEventListener('click', function() {
            const resultDiv = document.getElementById('formDataResult');
            
            // Simulate form data collection
            const formData = {
                name: "John Doe",
                citizenship: "Indian",
                age: 22,
                eduMin: "BCA",
                skills: "Python, SQL, Machine Learning",
                domain: "Data Science",
                location: "Remote",
                duration: "12 Months",
                edu: "Not in full-time",
                income: "Up to ₹8,00,000",
                aadhaarLink: "yes",
                govtJob: "no"
            };
            
            resultDiv.innerHTML = `<p class="success">✅ Form data collection successful</p><pre>${JSON.stringify(formData, null, 2)}</pre>`;
        });
        
        // Test AI recommendation
        document.getElementById('testAI').addEventListener('click', async function() {
            const resultDiv = document.getElementById('aiResult');
            resultDiv.innerHTML = '<p class="info">Testing AI recommendation...</p>';
            
            try {
                const testData = {
                    "name": "John Doe",
                    "citizenship": "Indian",
                    "age": 22,
                    "eduMin": "BCA",
                    "skills": "Python, SQL, Machine Learning",
                    "domain": "Data Science",
                    "location": "Remote",
                    "duration": "12 Months",
                    "edu": "Not in full-time",
                    "income": "Up to ₹8,00,000",
                    "aadhaarLink": "yes",
                    "govtJob": "no"
                };
                
                console.log("Sending test data:", testData);
                
                const response = await fetch('http://localhost:5000/ai_recommend', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData)
                });
                
                console.log("Response received:", response);
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.innerHTML = `<p class="success">✅ AI recommendation successful</p><pre>${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    const errorText = await response.text();
                    resultDiv.innerHTML = `<p class="error">❌ AI recommendation failed with status ${response.status}: ${errorText}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p class="error">❌ AI recommendation failed: ${error.message}</p>`;
            }
        });
        
        // Test form submission
        document.getElementById('submitTestForm').addEventListener('click', async function() {
            const resultDiv = document.getElementById('formSubmitResult');
            resultDiv.innerHTML = '<p class="info">Collecting form data...</p>';
            
            try {
                // Collect form data
                const formData = {
                    name: document.getElementById("name").value,
                    citizenship: document.getElementById("citizenship").value,
                    age: parseInt(document.getElementById("age").value),
                    eduMin: document.getElementById("eduMin").value,
                    skills: document.getElementById("skills").value,
                    domain: document.getElementById("domain").value,
                    location: document.getElementById("location").value,
                    duration: document.getElementById("duration").value,
                    edu: document.getElementById("edu").value,
                    income: document.getElementById("income").value,
                    aadhaarLink: document.getElementById("aadhaarLink").value,
                    govtJob: document.getElementById("govtJob").value
                };
                
                resultDiv.innerHTML = `<p class="info">Sending form data...</p><pre>${JSON.stringify(formData, null, 2)}</pre>`;
                
                // Send to backend
                const response = await fetch('http://localhost:5000/ai_recommend', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.innerHTML += `<p class="success">✅ Form submission successful</p><pre>${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    const errorText = await response.text();
                    resultDiv.innerHTML += `<p class="error">❌ Form submission failed with status ${response.status}: ${errorText}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML += `<p class="error">❌ Form submission failed: ${error.message}</p>`;
            }
        });
    </script>
</body>
</html>